

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial &mdash; Nemoh2HDB  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Source code documentation" href="Source_code_doc.html" />
    <link rel="prev" title="Welcome to Nemoh2HDB’s documentation!" href="../index.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Nemoh2HDB
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#python-script-template">1) Python script Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hdb5-structure">2) HDB5 structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-nemoh-input-and-output-files">3) Reading <em>Nemoh</em> input and output files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#discretization">4) Discretization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hydrostatics">5) Hydrostatics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wave-drift">6) Wave drift</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plots">7) Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filtering-of-the-impulse-response-functions">8) Filtering of the impulse response functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-the-hdb5">9) Writing the <em>.hdb5</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-nemoh2hdb">10) Running <em>Nemoh2HDB</em></a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Source_code_doc.html">Source code documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Nemoh2HDB</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Source/Tutorials.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<div class="section" id="python-script-template">
<h2>1) Python script Template<a class="headerlink" href="#python-script-template" title="Permalink to this headline">¶</a></h2>
<p>Starting from an empty Python script, it is necessary to include two libraries:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">HDF5</span> <span class="kn">import</span> <span class="n">HDB5</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>A main function has to be defined:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</pre></div>
</div>
<p>The script ends with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">=</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
   <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>The name of the script along with its location are unimportant. Every directory for both the input and output files will be specified in the script.</p>
<p><strong>All the commands presented in the next sections will have to be implemented within the main function.</strong></p>
</div>
<div class="section" id="hdb5-structure">
<h2>2) HDB5 structure<a class="headerlink" href="#hdb5-structure" title="Permalink to this headline">¶</a></h2>
<p>The main class of <em>Nemoh2HDB</em> is named <em>HDB5</em>. It stores and post-processes all the data resulted from <em>Nemoh</em>. This object needs to be initialized:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">database</span> <span class="o">=</span> <span class="n">HDB5</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-nemoh-input-and-output-files">
<h2>3) Reading <em>Nemoh</em> input and output files<a class="headerlink" href="#reading-nemoh-input-and-output-files" title="Permalink to this headline">¶</a></h2>
<p>For reading the <em>Nemoh</em> input and output files along with post-processing its data, the following subroutine has to be called:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">database</span><span class="o">.</span><span class="n">nemoh_reader</span><span class="p">(</span><span class="n">path_to_Nemoh_cal</span><span class="p">,</span><span class="n">nb_faces_by_wavelength</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>where:</dt>
<dd><ul class="first last simple">
<li><em>path_to_Nemoh_cal</em> represents the path to the <em>.cal</em> input file of <em>Nemoh</em>, by default path_to_Nemoh_cal = ‘.’;</li>
<li><em>nb_faces_by_wavelength</em> denotes the number of faces per wave length, by default equal to 10.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="discretization">
<h2>4) Discretization<a class="headerlink" href="#discretization" title="Permalink to this headline">¶</a></h2>
<p>To set the parameters for the new discretization of the impulse response functions, the two following parameters have to be specified:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">database</span><span class="o">.</span><span class="n">discretization</span><span class="o">.</span><span class="n">nb_wave_directions</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">database</span><span class="o">.</span><span class="n">discretization</span><span class="o">.</span><span class="n">nb_frequencies</span> <span class="o">=</span> <span class="mi">50</span>
</pre></div>
</div>
<p>In this case, the new discretization will have 15 wave directions and 50 frequencies.</p>
</div>
<div class="section" id="hydrostatics">
<h2>5) Hydrostatics<a class="headerlink" href="#hydrostatics" title="Permalink to this headline">¶</a></h2>
<p>Prior to setting the hydrostatic stiffness matrix of the bodies, it is necessary to creates a body structure. For instance, in case of a single body:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">body</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Then, the hydrostatics may be activated:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">body</span><span class="o">.</span><span class="n">activate_hydrostatic</span><span class="p">()</span>
</pre></div>
</div>
<p>And the hydrostatic matrix defined using:</p>
<blockquote>
<div><ul class="simple">
<li>coefficients:</li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">body</span><span class="o">.</span><span class="n">hydrostatic</span><span class="o">.</span><span class="n">k33</span> <span class="o">=</span> <span class="n">k33</span>
<span class="n">body</span><span class="o">.</span><span class="n">hydrostatic</span><span class="o">.</span><span class="n">k44</span> <span class="o">=</span> <span class="n">k44</span>
<span class="n">body</span><span class="o">.</span><span class="n">hydrostatic</span><span class="o">.</span><span class="n">k55</span> <span class="o">=</span> <span class="n">k55</span>
<span class="n">body</span><span class="o">.</span><span class="n">hydrostatic</span><span class="o">.</span><span class="n">k34</span> <span class="o">=</span> <span class="n">k34</span>
<span class="n">body</span><span class="o">.</span><span class="n">hydrostatic</span><span class="o">.</span><span class="n">k35</span> <span class="o">=</span> <span class="n">k35</span>
<span class="n">body</span><span class="o">.</span><span class="n">hydrostatic</span><span class="o">.</span><span class="n">k45</span> <span class="o">=</span> <span class="n">k45</span>
</pre></div>
</div>
<blockquote>
<div><ul class="simple">
<li>diagonal and off-diagonal terms:</li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">body</span><span class="o">.</span><span class="n">hydrostatic</span><span class="o">.</span><span class="n">diagonal</span> <span class="o">=</span> <span class="p">[</span><span class="n">k33</span><span class="p">,</span> <span class="n">k44</span><span class="p">,</span> <span class="n">k55</span><span class="p">]</span>
<span class="n">body</span><span class="o">.</span><span class="n">hydrostatic</span><span class="o">.</span><span class="n">non_diagonal</span> <span class="o">=</span> <span class="p">[</span><span class="n">k34</span><span class="p">,</span><span class="n">k35</span><span class="p">,</span><span class="n">k45</span><span class="p">]</span>
</pre></div>
</div>
<blockquote>
<div><ul class="simple">
<li>a matrix:</li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">body</span><span class="o">.</span><span class="n">hydrostatic</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">k33</span><span class="p">,</span><span class="n">k34</span><span class="p">,</span><span class="n">k35</span><span class="p">],[</span><span class="n">k43</span><span class="p">,</span><span class="n">k44</span><span class="p">,</span><span class="n">k45</span><span class="p">],[</span><span class="n">k53</span><span class="p">,</span><span class="n">k54</span><span class="p">,</span><span class="n">k55</span><span class="p">]])</span>
</pre></div>
</div>
<p>The values of k33, k34, …, k55 must be given.</p>
</div>
<div class="section" id="wave-drift">
<h2>6) Wave drift<a class="headerlink" href="#wave-drift" title="Permalink to this headline">¶</a></h2>
<p>To take into account the wave drift, polar coefficients needs to be given. They depend on both the frequency and the wave direction.</p>
<p>If a body structure was not initialized, follow the first step of the previous section. To active the wave drift, the command is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">body</span><span class="o">.</span><span class="n">activate_wave_drift</span><span class="p">()</span>
</pre></div>
</div>
<p>The frequency discretization and the polar coefficients may be written as follow (here for 4 different frequencies):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">,</span> <span class="n">f4</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">coeff_1</span><span class="p">,</span> <span class="n">coeff_2</span><span class="p">,</span> <span class="n">coeff_3</span><span class="p">,</span> <span class="n">coeff_4</span><span class="p">])</span>
</pre></div>
</div>
<p>Then the angular discretization has to be give (here for an angle <em>theta</em>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">body</span><span class="o">.</span><span class="n">wave_drift</span><span class="o">.</span><span class="n">add_cx</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">unit_dir</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">unit_freq</span><span class="o">=</span><span class="s1">&#39;rads&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This previous line needs to be written as many as the number of angular discretization (by changing the value of <em>theta</em>).</p>
<p>For doing a new discretization with respect to the frequency, it is necessary to give a new number of frequencies (here 10):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">body</span><span class="o">.</span><span class="n">wave_drift</span><span class="o">.</span><span class="n">nb_frequencies</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="section" id="plots">
<h2>7) Plots<a class="headerlink" href="#plots" title="Permalink to this headline">¶</a></h2>
<p>Several quantities may be plotted:</p>
<blockquote>
<div><ul class="simple">
<li>Added mass and damping coefficients:</li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">database</span><span class="o">.</span><span class="n">_hdb</span><span class="o">.</span><span class="n">radiation_db</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ibody_motion</span><span class="p">,</span> <span class="n">idof</span><span class="p">,</span> <span class="n">ibody_force</span><span class="p">,</span> <span class="n">iforce</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Where:</dt>
<dd><ul class="first last simple">
<li><em>ibody_motion</em> is the index of the moving body;</li>
<li><em>idof</em> represents the local body radiation mode;</li>
<li><em>ibody_force</em> denotes the body where the radiation force is applied;</li>
<li><em>iforce</em> is the local body force mode.</li>
</ul>
</dd>
</dl>
<p>All the added mass and damping coefficients may be displayed in one time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">database</span><span class="o">.</span><span class="n">_hdb</span><span class="o">.</span><span class="n">radiation_db</span><span class="o">.</span><span class="n">plot_added_mass_array</span><span class="p">()</span>
<span class="n">database</span><span class="o">.</span><span class="n">_hdb</span><span class="o">.</span><span class="n">radiation_db</span><span class="o">.</span><span class="n">plot_radiation_damping_array</span><span class="p">()</span>
</pre></div>
</div>
<blockquote>
<div><ul class="simple">
<li>Exciting loads:</li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">database</span><span class="o">.</span><span class="n">_hdb</span><span class="o">.</span><span class="n">wave_excitation_db</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ibody</span><span class="p">,</span> <span class="n">iforce</span><span class="p">,</span> <span class="n">iwave</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>with:</dt>
<dd><ul class="first last simple">
<li><em>ibody</em> the index of the body;</li>
<li><em>iforce</em> the index of the body force mode;</li>
<li><em>iwave</em> the index of the wave direction.</li>
</ul>
</dd>
</dl>
<p>This subroutine may be also used with the diffraction loads and the Froude-Krylov loads:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">database</span><span class="o">.</span><span class="n">_hdb</span><span class="o">.</span><span class="n">diffraction_db</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ibody</span><span class="p">,</span> <span class="n">iforce</span><span class="p">,</span> <span class="n">iwave</span><span class="p">)</span>
<span class="n">database</span><span class="o">.</span><span class="n">_hdb</span><span class="o">.</span><span class="n">froude_krylov_db</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ibody</span><span class="p">,</span> <span class="n">iforce</span><span class="p">,</span> <span class="n">iwave</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><ul class="simple">
<li>Impulse response functions:</li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">database</span><span class="o">.</span><span class="n">_hdb</span><span class="o">.</span><span class="n">radiation_db</span><span class="o">.</span><span class="n">get_irf_db</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ibody_motion</span><span class="p">,</span> <span class="n">idof</span><span class="p">,</span> <span class="n">ibody_force</span><span class="p">,</span> <span class="n">iforce</span><span class="p">)</span>
</pre></div>
</div>
<p>The definition of the input parameters is the same as for the added mass and damping coefficients.</p>
<blockquote>
<div><ul class="simple">
<li>Impulse response functions relative to the ship advance speed:</li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">database</span><span class="o">.</span><span class="n">_hdb</span><span class="o">.</span><span class="n">radiation_db</span><span class="o">.</span><span class="n">get_irf_ku</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ibody_motion</span><span class="p">,</span> <span class="n">idof</span><span class="p">,</span> <span class="n">ibody_force</span><span class="p">,</span> <span class="n">iforce</span><span class="p">)</span>
</pre></div>
</div>
<p>The definition of the input parameters is the same as for the added mass and damping coefficients.</p>
</div>
<div class="section" id="filtering-of-the-impulse-response-functions">
<h2>8) Filtering of the impulse response functions<a class="headerlink" href="#filtering-of-the-impulse-response-functions" title="Permalink to this headline">¶</a></h2>
<p>To improve the quality of the impulse response functions, it is possible to filter them using a cutoff scaling function, the following command may be used:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">database</span><span class="o">.</span><span class="n">_initialize</span><span class="p">()</span>
<span class="n">body</span><span class="o">.</span><span class="n">cutoff_scaling_irf_k</span><span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">i_body_motion</span><span class="p">,</span> <span class="n">i_force</span><span class="p">,</span> <span class="n">i_dof</span><span class="p">,</span> <span class="n">auto_apply</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>where:</dt>
<dd><ul class="first last simple">
<li><em>tc</em> is the cutting time;</li>
<li><em>i_body_motion</em> represents the index of the moving body;</li>
<li><em>i_force</em> denotes the index of the force of the moving body;</li>
<li><em>i_dof</em> is index of the dof of the moving body;</li>
<li><em>auto_apply</em> indicates if the application of the filtering is automatic or not (by default auto_apply = False).</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="writing-the-hdb5">
<h2>9) Writing the <em>.hdb5</em><a class="headerlink" href="#writing-the-hdb5" title="Permalink to this headline">¶</a></h2>
<p>The <em>.hdb5</em> is generated using the following subroutine:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">database</span><span class="o">.</span><span class="n">write_hdb5</span><span class="p">(</span><span class="n">path_and_name_to_hdb5_file</span><span class="p">)</span>
</pre></div>
</div>
<p>where <em>path_and_name_to_hdb5_file</em> represents the path including the name with its extension of the <em>.hdb5</em> file.</p>
<p>By default, path_and_name_to_hdb5_file = ‘frydom.hdb5’.</p>
</div>
<div class="section" id="running-nemoh2hdb">
<h2>10) Running <em>Nemoh2HDB</em><a class="headerlink" href="#running-nemoh2hdb" title="Permalink to this headline">¶</a></h2>
<p>To run <em>Nemoh2HDB</em>, use the following command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">Name_of_my_Python_file</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Source_code_doc.html" class="btn btn-neutral float-right" title="Source code documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral" title="Welcome to Nemoh2HDB’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, D-ICE Engineering

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>